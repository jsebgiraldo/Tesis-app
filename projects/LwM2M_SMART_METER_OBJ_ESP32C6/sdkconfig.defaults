# Disable SNTP by default (requested)
# CONFIG_SNTP_ENABLE is not set
#
# WiFi Provisioning Configuration
#
CONFIG_PROV_TRANSPORT_BLE=y
# CONFIG_PROV_TRANSPORT_SOFTAP is not set
CONFIG_PROV_SECURITY_VERSION=1
CONFIG_PROV_SEC2_DEV_MODE=y
CONFIG_PROV_SEC2_USERNAME="wifiprov"
CONFIG_PROV_SEC2_PASSWORD="abcd1234"
CONFIG_PROV_SHOW_QR=y
# CONFIG_PROV_RESET_PROVISIONED is not set
CONFIG_PROV_REPROVISIONING=y
CONFIG_PROV_RESET_PROV_MGR_ON_FAILURE=y
CONFIG_PROV_MGR_CONNECTION_CNT=3

#
# Bluetooth Configuration (Required for BLE provisioning)
#
CONFIG_BT_ENABLED=y
CONFIG_BT_NIMBLE_ENABLED=y
CONFIG_BT_NIMBLE_MAX_CONNECTIONS=1
CONFIG_BT_NIMBLE_MAX_CCCDS=8
CONFIG_BT_NIMBLE_ROLE_PERIPHERAL=y
CONFIG_BT_NIMBLE_ROLE_BROADCASTER=y
# Disable Extended Advertising to use legacy 31-byte payload compatible with protocomm
# (avoids rc=8 when setting adv data)
# CONFIG_BT_NIMBLE_EXT_ADV is not set
CONFIG_BT_LE_DFT_TX_POWER_LEVEL_P9=y

# Make NimBLE GAP device name shorter to fit scan lists
CONFIG_BT_NIMBLE_SVC_GAP_DEVICE_NAME="PROV"
CONFIG_BT_NIMBLE_GAP_DEVICE_NAME_MAX_LEN=12

#
# WiFi Provisioning Component Configuration
#
CONFIG_WIFI_PROV_SCAN_MAX_ENTRIES=16
CONFIG_WIFI_PROV_AUTOSTOP_TIMEOUT=30
CONFIG_WIFI_PROV_BLE_BONDING=y
CONFIG_WIFI_PROV_BLE_SEC_CONN=y
CONFIG_WIFI_PROV_KEEP_BLE_ON_AFTER_PROV=n

#
# Enable Protocol Communication Component
#
CONFIG_ESP_PROTOCOMM_SUPPORT_SECURITY_VERSION_0=y
CONFIG_ESP_PROTOCOMM_SUPPORT_SECURITY_VERSION_1=y
CONFIG_ESP_PROTOCOMM_SUPPORT_SECURITY_VERSION_2=y

## Wiâ€‘Fi SSID/Password removed: use BLE provisioning to set credentials at runtime

# LwM2M server host is handled via CONFIG_LWM2M_OVERRIDE_HOSTNAME (default "192.168.3.100")
# Scheme/port are selected in menuconfig (default coap/5685). Obsolete keys removed.


#
# LwM2M client defaults (buffers, lifetime, server setup)
#
CONFIG_LWM2M_IN_BUFFER_SIZE=4000
CONFIG_LWM2M_OUT_BUFFER_SIZE=4000
CONFIG_LWM2M_MSG_CACHE_SIZE=4000
CONFIG_LWM2M_SERVER_SHORT_ID=123
CONFIG_LWM2M_START_DELAY_MS=1000

# Server address defaults
CONFIG_LWM2M_OVERRIDE_HOSTNAME_ENABLE=y
CONFIG_LWM2M_OVERRIDE_HOSTNAME="192.168.3.100"
CONFIG_LWM2M_SERVER_PORT=5683

# Default to CoAP (UDP). To use CoAPS (DTLS), set this to y in menuconfig or here.
# CONFIG_LWM2M_SERVER_SCHEME_COAPS is not set

# Optional PSK settings (used only if COAPS is enabled)
CONFIG_LWM2M_SECURITY_PSK_ID=""
CONFIG_LWM2M_SECURITY_PSK_KEY=""


#
# TLS/DTLS and mbedTLS defaults for stable builds (ESP-IDF 5.4.1 + Anjay)
# These defaults ensure DTLS/TLS and certificates/PSK features are available
# even if COAPS is disabled at runtime. Safe to keep enabled for COAP.
#
CONFIG_ESP_TLS_USING_MBEDTLS=y

# mbedTLS memory/IO sizes (tuned to fit typical ESP32-C6 RAM)
CONFIG_MBEDTLS_INTERNAL_MEM_ALLOC=y
CONFIG_MBEDTLS_ASYMMETRIC_CONTENT_LEN=y
CONFIG_MBEDTLS_SSL_IN_CONTENT_LEN=16384
CONFIG_MBEDTLS_SSL_OUT_CONTENT_LEN=4096
CONFIG_MBEDTLS_SSL_KEEP_PEER_CERTIFICATE=y

# Protocols
CONFIG_MBEDTLS_SSL_PROTO_TLS1_2=y
CONFIG_MBEDTLS_SSL_PROTO_DTLS=y

# X.509 and PEM (needed for certificate-based security; harmless if using PSK)
CONFIG_MBEDTLS_PEM_PARSE_C=y
CONFIG_MBEDTLS_PEM_WRITE_C=y
CONFIG_MBEDTLS_X509_CRT_PARSE_C=y
CONFIG_MBEDTLS_X509_CRL_PARSE_C=y
CONFIG_MBEDTLS_X509_CSR_PARSE_C=y

# ECC and ECDSA/ECDH (common in LwM2M/DTLS)
CONFIG_MBEDTLS_ECP_C=y
CONFIG_MBEDTLS_ECDH_C=y
CONFIG_MBEDTLS_ECDSA_C=y
CONFIG_MBEDTLS_ECP_NIST_OPTIM=y
CONFIG_MBEDTLS_ECDSA_DETERMINISTIC=y

# Crypto primitives
CONFIG_MBEDTLS_AES_C=y
CONFIG_MBEDTLS_CCM_C=y
CONFIG_MBEDTLS_SHA256_C=y
CONFIG_MBEDTLS_MD_C=y
CONFIG_MBEDTLS_ENTROPY_HARDWARE=y

# PSK modes (for DTLS-PSK if you enable COAPS with PSK on the server)
CONFIG_MBEDTLS_PSK_MODES=y
CONFIG_MBEDTLS_KEY_EXCHANGE_PSK=y
CONFIG_MBEDTLS_KEY_EXCHANGE_ECDHE_PSK=y
CONFIG_MBEDTLS_KEY_EXCHANGE_RSA_PSK=y
CONFIG_MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA=y
