{
  "name": "ESP-IDF (ESP32) Dev",
  "image": "espressif/idf:latest",
  "runArgs": [
  "--privileged",
  // Map common serial devices (adjust or duplicate if your board shows up on a different index)
  "--device=/dev/ttyUSB0",
  "--device=/dev/ttyACM0",
  // Pass through whole USB bus (helps with USB JTAG/CDC and hot-plug)
  "--mount=type=bind,source=/dev/bus/usb,target=/dev/bus/usb",
  // If you switch to a non-root user, this grants serial access
  "--group-add=dialout"
  ],
  "remoteUser": "root",
  "workspaceFolder": "/workspaces/${localWorkspaceFolderBasename}",
  "workspaceMount": "source=${localWorkspaceFolder},target=/workspaces/${localWorkspaceFolderBasename},type=bind,consistency=cached",
  "containerEnv": {
    "IDF_PATH": "/opt/esp/idf"
  },
  "postCreateCommand": "/bin/bash -lc 'source /opt/esp/idf/export.sh && idf.py --version || python --version'",
  "customizations": {
    "vscode": {
      "extensions": [
        "espressif.esp-idf-extension",
        "ms-vscode.cpptools",
        "ms-vscode.cmake-tools",
        "ms-python.python"
      ]
    }
  },
  "hostRequirements": {
    "cpus": 2,
    "memory": "4gb"
  },
  "onCreateCommand": "git config --global --add safe.directory ${containerWorkspaceFolder}",
  "shutdownAction": "stopContainer"
}
